<%- include('partials/header', {user: user, isAdmin: true}) %>
  <div class="content-container">
    <div class="page-hero">
      <h1>ðŸ“‹ Custom Embeds</h1>
      <p class="intro-text">Create and manage custom embeds with buttons</p>
    </div>

    <!-- Create New Embed -->
    <div class="card">
      <div class="card-header">
        <h3>âž• Create New Embed</h3>
      </div>
      <div class="card-body">
        <form action="/admin/embeds/create" method="POST" class="embed-form">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Embed Name *</label>
              <input type="text" name="name" id="name" required placeholder="unique-name">
            </div>
            <div class="form-group">
              <label for="color">Color</label>
              <input type="color" name="color" id="color" value="#3b82f6">
            </div>
          </div>
          <div class="form-group">
            <label for="title">Title *</label>
            <input type="text" name="title" id="title" required placeholder="Embed Title">
          </div>
          <div class="form-group">
            <label for="description">Description</label>
            <textarea name="description" id="description" rows="4" placeholder="Embed description (supports Markdown)"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="footer">Footer</label>
              <input type="text" name="footer" id="footer" placeholder="Footer text">
            </div>
            <div class="form-group">
              <label for="image">Image URL</label>
              <input type="url" name="image" id="image" placeholder="https://...">
            </div>
          </div>
          <button type="submit" class="btn btn-primary">Create Embed</button>
        </form>
      </div>
    </div>

    <!-- Existing Embeds -->
    <div class="table-section">
      <h3>ðŸ“¦ Saved Embeds <span class="count"><%= (embeds || []).length %></span></h3>
      <div class="table-container">
        <% if ((embeds || []).length === 0) { %>
          <div class="empty-state">
            <h4>No custom embeds</h4>
            <p>Create your first custom embed above</p>
          </div>
        <% } else { %>
          <div class="embed-grid">
            <% embeds.forEach(function(embed) { %>
              <div class="embed-card">
                <div class="embed-preview" style="border-left-color: <%= embed.color || '#3b82f6' %>">
                  <h4><%= embed.title %></h4>
                  <p class="muted"><%= (embed.description || 'No description').substring(0, 100) %><%= (embed.description || '').length > 100 ? '...' : '' %></p>
                  <div class="embed-meta">
                    <span class="mono"><%= embed.name %></span>
                    <span class="badge"><%= (embed.buttons || []).length %> buttons</span>
                  </div>
                </div>
                <div class="embed-actions">
                  <a href="/admin/embeds/<%= embed._id %>" class="btn btn-sm btn-secondary">Edit</a>
                  <form action="/admin/embeds/<%= embed._id %>/delete" method="POST" style="display:inline">
                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Delete this embed?')">Delete</button>
                  </form>
                </div>
              </div>
            <% }) %>
          </div>
        <% } %>
      </div>
    </div>
  </div>

  <style>
    .embed-form {
      max-width: 600px;
    }
    .form-group {
      margin-bottom: 1rem;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--text-secondary);
    }
    .form-group input, .form-group textarea {
      width: 100%;
      padding: 0.75rem 1rem;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: var(--text-primary);
    }
    .form-group input[type="color"] {
      height: 42px;
      padding: 0.25rem;
      cursor: pointer;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 1rem;
    }
    .embed-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }
    .embed-card {
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      overflow: hidden;
    }
    .embed-preview {
      padding: 1rem;
      border-left: 4px solid #3b82f6;
      background: rgba(0,0,0,0.2);
    }
    .embed-preview h4 {
      margin: 0 0 0.5rem 0;
    }
    .embed-preview p {
      margin: 0 0 0.75rem 0;
      font-size: 0.9rem;
    }
    .embed-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.8rem;
    }
    .embed-actions {
      padding: 0.75rem 1rem;
      display: flex;
      gap: 0.5rem;
    }
    .badge {
      padding: 0.25rem 0.5rem;
      background: rgba(59, 130, 246, 0.2);
      border-radius: 4px;
      font-size: 0.75rem;
    }
  </style>
<%- include('partials/footer') %>
