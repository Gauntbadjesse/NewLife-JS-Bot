<%- include('partials/header', {user: user, isAdmin: typeof isAdmin !== 'undefined' ? isAdmin : false}) %>
  <div class="content-container">
    <div class="page-hero">
      <h1>üîó Link Minecraft Account</h1>
      <p class="intro-text">Link your Minecraft accounts to your Discord. You can link multiple accounts (Java & Bedrock).</p>
    </div>

    <div class="card">
      <% if (error) { %>
        <div class="alert alert-danger"><%= error %></div>
      <% } %>
      <% if (success) { %>
        <div class="alert alert-success"><%= success %></div>
      <% } %>

      <h3>Add New Account</h3>
      <form method="POST" action="/link-mc">
        <div style="margin-bottom: 12px;">
          <label for="platform">Platform</label>
          <select id="platform" name="platform" required style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #2b2d31; color: #fff;">
            <option value="java">‚òï Java Edition</option>
            <option value="bedrock">üü¶ Bedrock Edition</option>
          </select>
        </div>
        <div style="margin-bottom: 12px;">
          <label for="username">Minecraft Username</label>
          <input type="text" id="username" name="username" placeholder="Notch" required />
          <small style="color: #888; display: block; margin-top: 4px;">Bedrock: Include the <code>.</code> prefix if your gamertag has one</small>
        </div>
        <div style="margin-top:12px; display:flex; gap:8px;">
          <button class="btn btn-primary" type="submit">Link Account</button>
          <a href="/" class="btn btn-secondary">Back to Dashboard</a>
        </div>
      </form>
    </div>

    <% if (typeof linkedAccounts !== 'undefined' && linkedAccounts && linkedAccounts.length > 0) { %>
    <div class="card" style="margin-top: 20px;">
      <h3>Your Linked Accounts</h3>
      <table class="data-table">
        <thead>
          <tr>
            <th>Platform</th>
            <th>Username</th>
            <th>UUID</th>
            <th>Linked</th>
          </tr>
        </thead>
        <tbody>
          <% linkedAccounts.forEach(function(acc) { %>
          <tr>
            <td><%= acc.platform === 'bedrock' ? 'üü¶ Bedrock' : 'üü© Java' %><%= acc.primary ? ' ‚≠ê' : '' %></td>
            <td><strong><%= acc.minecraftUsername %></strong></td>
            <td><code style="font-size: 11px;"><%= acc.uuid %></code></td>
            <td><%= new Date(acc.linkedAt).toLocaleDateString() %></td>
          </tr>
          <% }); %>
        </tbody>
      </table>
      <p style="margin-top: 10px; color: #888; font-size: 12px;">‚≠ê = Primary account (used for nickname)</p>
    </div>
    <% } %>

  </div>
<%- include('partials/footer') %>
